<html>
  <head>
    <!--  <center><a href="https://jonathanroiz.github.io/" style="font-size: 40px; text-decoration: none; color:black;">Home</a></center>  -->
    <title>Flappy Bird</title>
    <style>
      canvas {background-color: powderblue;}
      canvas {
        padding: 0;
        margin: auto;
        display: block;
        position: absolute;
        top: 0;
        bottom: 0;
        left: 0;
        right: 0;
      }
    </style>
  </head>
  <body>
    <canvas id="myCanvas" width=100% height=100% style="border:1px solid #00bfff"> ></canvas>
    <script language = "javascript">
      var canvas = document.getElementById("myCanvas");
      var ctx = canvas.getContext("2d");
      var birdRadius = 20;
      var spacePressed = false;
      var score = 0;
      
      function drawText() {
      	ctx.fillStyle = "blue";
        ctx.font = "70px Arial"; // new code
        ctx.textAlign = "center";
        ctx.fillText(score, canvas.width/2,70);
      }
      
      canvas.width  = window.innerWidth/1.005;
      canvas.height = window.innerHeight/1.005;
      
      var x = canvas.width/5;
      var y = canvas.height/2;
      
      var obsX = canvas.width;
      var obsX2 = canvas.width*1.5;
      var obsY = canvas.height;
      var randomOffset = 2.2//2.148
      var randomHeight = randomOffset;//(Math.random()/2) + randomOffset;
      var randomHeight2 = randomOffset;//(Math.random()/2) + randomOffset;
      var randomHeight3 = (Math.random()/2) + randomOffset;
      var randomHeight4 = (Math.random()/2) + randomOffset;
      var obsWidth = 50;
      var obsHeight = canvas.height/randomHeight;
      var obsHeight2 = canvas.height/randomHeight2;
      var obsHeight3 = canvas.height/randomHeight3;
      var obsHeight4 = canvas.height/randomHeight4;
      var obsIncrement = -6;
      var fallSpeed = 4;
      
      document.addEventListener("keydown", keyDownHandler, false);
      document.addEventListener("keyup", keyUpHandler, false);
      
      function keyDownHandler(e) {
        if(e.keyCode == 32) {
            spacePressed = true;
        }
      }
      function keyUpHandler(e) {
          if(e.keyCode == 32) {
              spacePressed = false;
          }
      }
      
      function drawBird() {
        ctx.moveTo(x,y);
        ctx.beginPath();
        ctx.arc(x, y, birdRadius, 0, Math.PI*2);
        ctx.fillStyle = "#FFFF00";
        ctx.fill();
        ctx.closePath();
      }
      
      function drawObstacle() {
        ctx.fillStyle = "	#008000";
        ctx.fillRect(obsX,obsY-obsHeight,obsWidth,obsHeight);
        ctx.fillRect(obsX,0,obsWidth,obsHeight2);
      }
      function drawObstacle2() {
        ctx.fillRect(obsX2,obsY-obsHeight3,obsWidth,obsHeight3);
        ctx.fillRect(obsX2,0,obsWidth,obsHeight4); //Changed Code
      }
      
      setInterval(function(){
          if (y <= canvas.height - 21) {
            y += fallSpeed;
          }
      }, 25);
      
      setInterval(function(){ 
        var rect1 = {x: obsX, y: obsY-obsHeight, width: obsWidth, height: obsHeight}
        var rect2 = {x: x, y: y, width: 21, height: 21}
        var rect3 = {x: obsX, y: 0, width: obsWidth, height: obsHeight2+20}
        var rect4 = {x: obsX2, y: obsY-obsHeight3, width: obsWidth, height: obsHeight3}
        var rect5 = {x: obsX2, y: 0, width: obsWidth, height: obsHeight4+20}
        
        if (rect1.x < rect2.x + rect2.width &&
          rect1.x + rect1.width > rect2.x &&
          rect1.y < rect2.y + rect2.height &&
          rect1.y + rect1.height > rect2.y) {
          // collision detected!
          obsIncrement = 0;
          fallSpeed = 0;
          randomHeight = (Math.random()/2) + randomOffset
          randomHeight2 = (Math.random()/2) + randomOffset
          randomHeight3 = (Math.random()/2) + randomOffset
          randomHeight4 = (Math.random()/2) + randomOffset
          obsHeight = canvas.height/randomHeight;
          obsHeight2 = canvas.height/randomHeight2;
          obsHeight3 = canvas.height/randomHeight3;
          obsHeight4 = canvas.height/randomHeight4;
          obsX = canvas.width;
          obsX2 = canvas.width * 1.5;
          score = 0;
          x = canvas.width/5;
          y = canvas.height/2;
        } else if (rect3.x < rect2.x + rect2.width &&
          rect3.x + rect3.width > rect2.x &&
          rect3.y < rect2.y + rect2.height &&
          rect3.y + rect3.height > rect2.y) {
          obsIncrement = 0;
          fallSpeed = 0;
          randomHeight = (Math.random()/2) + randomOffset
          randomHeight2 = (Math.random()/2) + randomOffset
          randomHeight3 = (Math.random()/2) + randomOffset
          randomHeight4 = (Math.random()/2) + randomOffset
          obsHeight = canvas.height/randomHeight;
          obsHeight2 = canvas.height/randomHeight2;
          obsHeight3 = canvas.height/randomHeight3;
          obsHeight4 = canvas.height/randomHeight4;
          obsX = canvas.width;
          obsX2 = canvas.width * 1.5;
          score = 0;
          x = canvas.width/5;
          y = canvas.height/2;
        } else if (rect4.x < rect2.x + rect2.width &&
          rect4.x + rect4.width > rect2.x &&
          rect4.y < rect2.y + rect2.height &&
          rect4.y + rect4.height > rect2.y) {
          obsIncrement = 0;
          fallSpeed = 0;
          randomHeight = (Math.random()/2) + randomOffset
          randomHeight2 = (Math.random()/2) + randomOffset
          randomHeight3 = (Math.random()/2) + randomOffset
          randomHeight4 = (Math.random()/2) + randomOffset
          obsHeight = canvas.height/randomHeight;
          obsHeight2 = canvas.height/randomHeight2;
          obsHeight3 = canvas.height/randomHeight3;
          obsHeight4 = canvas.height/randomHeight4;
          obsX = canvas.width;
          obsX2 = canvas.width * 1.5;
          score = 0;
          x = canvas.width/5;
          y = canvas.height/2;
        } else if (rect5.x < rect2.x + rect2.width &&
          rect5.x + rect5.width > rect2.x &&
          rect5.y < rect2.y + rect2.height &&
          rect5.y + rect5.height > rect2.y) {
          obsIncrement = 0;
          fallSpeed = 0;
          randomHeight = (Math.random()/2) + randomOffset
          randomHeight2 = (Math.random()/2) + randomOffset
          randomHeight3 = (Math.random()/2) + randomOffset
          randomHeight4 = (Math.random()/2) + randomOffset
          obsHeight = canvas.height/randomHeight;
          obsHeight2 = canvas.height/randomHeight2;
          obsHeight3 = canvas.height/randomHeight3;
          obsHeight4 = canvas.height/randomHeight4;
          obsX = canvas.width;
          obsX2 = canvas.width * 1.5;
          score = 0;
          x = canvas.width/5;
          y = canvas.height/2;
        } else {
          obsIncrement = -6;
          fallSpeed = 4;
        }
        
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        drawBird();
        drawObstacle();
        drawObstacle2();
        drawText();
        
        obsX += obsIncrement;
        obsX2 += obsIncrement;
        if ((obsX < x-42) && (obsX > x-48)) {
          score += 1;
        }
        if ((obsX2 < x-42) && (obsX2 > x-48)) {
          score += 1;
        }

        if (obsX < -70) {
          randomHeight = (Math.random()/2) + randomOffset
          randomHeight2 = (Math.random()/2) + randomOffset
          obsHeight = canvas.height/randomHeight;
          obsHeight2 = canvas.height/randomHeight2;
          obsX = canvas.width;
        }
        if (obsX2 < -70) {
          randomHeight3 = (Math.random()/2) + randomOffset
          randomHeight4 = (Math.random()/2) + randomOffset
          obsHeight3 = canvas.height/randomHeight3;
          obsHeight4 = canvas.height/randomHeight4;
          obsX2 = canvas.width;
        }
        
            
        if (spacePressed) {
          if (y <= 20) {
            
          } else {
            y -= 8
          }
        }
      }, 25);
    </script>
  </body>
</html>
